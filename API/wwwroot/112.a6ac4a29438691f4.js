"use strict";(self.webpackChunkonline_board_game_frontend=self.webpackChunkonline_board_game_frontend||[]).push([[112],{6112:(X,f,s)=>{s.r(f),s.d(f,{LobbyModule:()=>G});var _=s(2163),u=s(9299),L=s(1843),c=s(9300),b=s(2722),y=s(5377),C=s(6145),t=s(4650),x=s(9845),v=s(3635),P=s(991),Z=s(5412),m=s(6895),p=s(4859),i=s(4006),O=s(9549),S=s(4144),T=s(6996),g=s(3081);function w(n,o){1&n&&t._UZ(0,"chat-message",7),2&n&&t.Q6J("message",o.$implicit)}let A=(()=>{class n{constructor(e){this.chatStore=e}ngOnInit(){this.createForm()}onSendMessage(){!y.g.isNil(this.form.value.message)&&""!==this.form.value.message&&(this.chatStore.sendMessage(this.form.value),this.form.reset())}createForm(){this.form=new i.cw({message:new i.NI(null)})}}return n.\u0275fac=function(e){return new(e||n)(t.Y36(v.s))},n.\u0275cmp=t.Xpm({type:n,selectors:[["chat"]],decls:11,vars:7,consts:[[1,"chat"],[1,"chat__messages"],[3,"message",4,"ngFor","ngForOf"],[1,"chat__send-message"],[1,"form",3,"formGroup"],["matInput","","formControlName","message",3,"keydown.enter"],["mat-flat-button","",3,"click"],[3,"message"]],template:function(e,a){1&e&&(t.TgZ(0,"div",0)(1,"div",1),t.YNc(2,w,1,1,"chat-message",2),t.ALo(3,"async"),t.qZA(),t.TgZ(4,"div",3)(5,"form",4)(6,"mat-form-field")(7,"input",5),t.NdJ("keydown.enter",function(){return a.onSendMessage()}),t.qZA()()(),t.TgZ(8,"button",6),t.NdJ("click",function(){return a.onSendMessage()}),t._uU(9),t.ALo(10,"translate"),t.qZA()()()),2&e&&(t.xp6(2),t.Q6J("ngForOf",t.lcZ(3,3,a.chatStore.chat$)),t.xp6(3),t.Q6J("formGroup",a.form),t.xp6(4),t.Oqu(t.lcZ(10,5,"chat.button.send")))},dependencies:[m.sg,i._Y,i.Fj,i.JJ,i.JL,i.sg,i.u,O.KE,S.Nt,p.lW,T.R,g.X$,m.Ov],styles:[".chat[_ngcontent-%COMP%]{width:100%;height:100%;padding:10px 15px;border:2px solid #000;border-radius:2px;background:linear-gradient(130deg,#1F1B30 0%,#2A1B30 100%)}.chat__messages[_ngcontent-%COMP%]{height:calc(100% - 52px);overflow-y:auto;margin-bottom:10px}.chat__send-message[_ngcontent-%COMP%]{display:flex;flex-direction:row;align-items:center;flex-wrap:nowrap;padding-right:10px;gap:20px}.chat__send-message[_ngcontent-%COMP%]   .form[_ngcontent-%COMP%]{margin-bottom:0;width:auto;flex:1}.chat__send-message[_ngcontent-%COMP%]     .mat-form-field-infix{border:0!important}"]}),n})();var M=s(7392),r=s(671);function k(n,o){1&n&&t._UZ(0,"mat-icon",11),2&n&&t.Q6J("svgIcon","crown-solid")}function R(n,o){if(1&n&&(t.TgZ(0,"td",9),t.YNc(1,k,1,1,"mat-icon",10),t.qZA()),2&n){const e=o.$implicit;t.xp6(1),t.Q6J("ngIf",null==e?null:e.isOwner)}}function N(n,o){if(1&n&&(t.TgZ(0,"td",9)(1,"div",12),t._uU(2),t.ALo(3,"translate"),t.qZA(),t.TgZ(4,"div",13),t._uU(5),t.qZA()()),2&n){const e=o.$implicit;t.xp6(2),t.Oqu(t.lcZ(3,2,"lobby.label.playerName")),t.xp6(3),t.Oqu(e.username)}}function J(n,o){if(1&n){const e=t.EpF();t.TgZ(0,"td",9)(1,"button",14),t.NdJ("click",function(){const d=t.CHM(e).$implicit,h=t.oxw(2);return t.KtG(h.onToggleReadiness(d))}),t._uU(2),t.ALo(3,"translate"),t.ALo(4,"translate"),t.qZA()()}if(2&n){const e=o.$implicit,a=t.oxw(2);t.xp6(1),t.Q6J("disabled",e.username!=(null==a.auth?null:a.auth.getUsername())),t.xp6(1),t.hij(" ",e.isReady?t.lcZ(3,2,"lobby.button.ready"):t.lcZ(4,4,"lobby.button.notReady")," ")}}function U(n,o){if(1&n){const e=t.EpF();t.TgZ(0,"button",16),t.NdJ("click",function(){t.CHM(e);const l=t.oxw().$implicit,d=t.oxw(2);return t.KtG(d.onKickPlayer(l))}),t._uU(1),t.ALo(2,"translate"),t.qZA()}2&n&&(t.xp6(1),t.hij(" ",t.lcZ(2,1,"lobby.button.kick")," "))}function $(n,o){if(1&n&&(t.TgZ(0,"td",9),t.YNc(1,U,3,3,"button",15),t.qZA()),2&n){const e=o.$implicit,a=t.oxw(2);t.xp6(1),t.Q6J("ngIf",a.isKickButtonVisible(e))}}function B(n,o){1&n&&t._UZ(0,"tr",17)}const Y=function(){return["isOwner","username","isReady","kickPlayer"]};function F(n,o){if(1&n&&(t.TgZ(0,"table",2),t.ALo(1,"async"),t.ynx(2,3),t.YNc(3,R,2,1,"td",4),t.BQk(),t.ynx(4,5),t.YNc(5,N,6,4,"td",4),t.BQk(),t.ynx(6,6),t.YNc(7,J,5,6,"td",4),t.BQk(),t.ynx(8,7),t.YNc(9,$,2,1,"td",4),t.BQk(),t.YNc(10,B,1,0,"tr",8),t.qZA()),2&n){const e=t.oxw();t.Q6J("dataSource",t.lcZ(1,2,e.lobbyStore.lobbyPlayers$)),t.xp6(10),t.Q6J("matRowDefColumns",t.DdM(4,Y))}}let I=(()=>{class n extends C.H{constructor(e,a){super(),this.lobbyStore=e,this.auth=a}ngOnInit(){this.initDataHandle()}onToggleReadiness(e){this.lobbyStore.changeReadiness(!e.isReady)}onKickPlayer(e){this.lobbyStore.kickPlayer(e)}isKickButtonVisible(e){const a=this.ownerUsername===this.auth.getUsername(),l=e.username!==this.auth.getUsername();return a&&l}initDataHandle(){this.lobbyStore.lobbyOwnerUsername$.pipe((0,c.h)(e=>!y.g.isNil(e)),(0,b.R)(this.destroyed$)).subscribe(e=>this.ownerUsername=e)}}return n.\u0275fac=function(e){return new(e||n)(t.Y36(x.e),t.Y36(P.e))},n.\u0275cmp=t.Xpm({type:n,selectors:[["lobby-players"]],features:[t.qOj],decls:3,vars:3,consts:[[1,"players"],["class","table","mat-table","",3,"dataSource",4,"ngIf"],["mat-table","",1,"table",3,"dataSource"],["matColumnDef","isOwner"],["mat-cell","",4,"matCellDef"],["matColumnDef","username"],["matColumnDef","isReady"],["matColumnDef","kickPlayer"],["mat-row","",4,"matRowDef","matRowDefColumns"],["mat-cell",""],[3,"svgIcon",4,"ngIf"],[3,"svgIcon"],[1,"mat-table__label"],[1,"mat-table__value"],["mat-flat-button","",3,"disabled","click"],["mat-flat-button","",3,"click",4,"ngIf"],["mat-flat-button","",3,"click"],["mat-row",""]],template:function(e,a){1&e&&(t.TgZ(0,"div",0),t.YNc(1,F,11,5,"table",1),t.ALo(2,"async"),t.qZA()),2&e&&(t.xp6(1),t.Q6J("ngIf",t.lcZ(2,1,a.lobbyStore.lobbyPlayers$)))},dependencies:[m.O5,M.Hw,p.lW,r.BZ,r.w1,r.Dz,r.nj,r.ev,r.Gk,g.X$,m.Ov],styles:[".players[_ngcontent-%COMP%]{width:100%;height:100%;padding:30px 20px;border:2px solid #000;border-radius:2px;background:linear-gradient(130deg,#1F1B30 0%,#2A1B30 100%)}.mat-column-isOwner[_ngcontent-%COMP%]{color:#ff6a4f;width:65px}.mat-column-username[_ngcontent-%COMP%]{width:calc(50% - 65px)}.mat-column-isReady[_ngcontent-%COMP%]{width:calc(50% - 120px);padding-right:10px;text-align:end}.mat-column-kickPlayer[_ngcontent-%COMP%]{width:120px}.mat-flat-button[_ngcontent-%COMP%]{width:120px;text-align:center}"]}),n})();function D(n,o){if(1&n){const e=t.EpF();t.TgZ(0,"button",6),t.NdJ("click",function(){t.CHM(e);const l=t.oxw();return t.KtG(l.onStartGame())}),t._uU(1),t.ALo(2,"translate"),t.qZA()}if(2&n){const e=t.oxw();t.Q6J("disabled",!e.isAllPlayersReady),t.xp6(1),t.Oqu(t.lcZ(2,2,"lobby.button.start"))}}const Q=[{path:"",component:(()=>{class n extends C.H{constructor(e,a,l,d,h,K){super(),this.lobbyStore=e,this.chatStore=a,this.auth=l,this.route=d,this.router=h,this.dialog=K,this.isAllPlayersReady=!1}ngOnInit(){this.initDataHandle(),this.lobbyStore.connectLobbyHub(),this.chatStore.connectChatHub()}onLeaveLobby(){this.lobbyStore.leaveLobby()}onCopyLobbyCode(){const e=document.createElement("textarea");e.style.opacity="0",e.style.height="0",e.style.width="0",e.value=this.lobbyStore.getLobbyId().toString(),document.body.appendChild(e),e.focus(),e.select(),document.execCommand("copy"),document.body.removeChild(e)}onStartGame(){this.lobbyStore.startTheGame()}isStartGameButtonVisible(){return this.ownerUsername===this.auth.getUsername()}checkIsAllPlayersReady(e){const a=e.find(l=>!1===l.isReady);this.isAllPlayersReady=void 0===a}initDataHandle(){this.lobbyStore.lobbyPlayers$.pipe((0,c.h)(e=>!y.g.isNil(e)),(0,b.R)(this.destroyed$)).subscribe(e=>this.checkIsAllPlayersReady(e)),this.lobbyStore.lobbyOwnerUsername$.pipe((0,c.h)(e=>!y.g.isNil(e)),(0,b.R)(this.destroyed$)).subscribe(e=>this.ownerUsername=e),this.lobbyStore.playerKickedSuccess$.pipe((0,c.h)(Boolean),(0,b.R)(this.destroyed$)).subscribe(()=>this.onLeaveLobby()),this.lobbyStore.playerLeftSuccess$.pipe((0,c.h)(Boolean),(0,b.R)(this.destroyed$)).subscribe(()=>{this.chatStore.disconnectChatHub(),this.router.navigate([""]),this.dialog.open(L.W,{autoFocus:!1,width:"800px"})})}ngOnDestroy(){this.lobbyStore.disconnectLobbyHub(),super.ngOnDestroy()}}return n.\u0275fac=function(e){return new(e||n)(t.Y36(x.e),t.Y36(v.s),t.Y36(P.e),t.Y36(u.gz),t.Y36(u.F0),t.Y36(Z.uw))},n.\u0275cmp=t.Xpm({type:n,selectors:[["lobby-page"]],features:[t.qOj],decls:11,vars:7,consts:[[1,"lobby-container"],[1,"players"],[1,"chat"],[1,"lobby-actions"],["mat-flat-button","",3,"click"],["mat-flat-button","",3,"disabled","click",4,"ngIf"],["mat-flat-button","",3,"disabled","click"]],template:function(e,a){1&e&&(t.TgZ(0,"div",0),t._UZ(1,"lobby-players",1)(2,"chat",2),t.TgZ(3,"div",3)(4,"button",4),t.NdJ("click",function(){return a.onCopyLobbyCode()}),t._uU(5),t.ALo(6,"translate"),t.qZA(),t.TgZ(7,"button",4),t.NdJ("click",function(){return a.onLeaveLobby()}),t._uU(8),t.ALo(9,"translate"),t.qZA(),t.YNc(10,D,3,4,"button",5),t.qZA()()),2&e&&(t.xp6(5),t.Oqu(t.lcZ(6,3,"lobby.button.copy")),t.xp6(3),t.Oqu(t.lcZ(9,5,"lobby.button.leave")),t.xp6(2),t.Q6J("ngIf",a.isStartGameButtonVisible()))},dependencies:[m.O5,p.lW,A,I,g.X$],styles:['.lobby-container[_ngcontent-%COMP%]{display:grid;grid-template-columns:1fr 1fr;grid-template-rows:1fr 1fr;grid-gap:20px;grid-template-areas:"players chat" "actions chat";width:100vw;height:100vh;padding:20px 30px;background:url(/assets/images/background/lobby-background-image.jpg) no-repeat;background-size:cover;background-position-y:bottom}.players[_ngcontent-%COMP%]{grid-area:players}.chat[_ngcontent-%COMP%]{grid-area:chat}.lobby-actions[_ngcontent-%COMP%]{grid-area:actions}.mat-flat-button[_ngcontent-%COMP%]{margin-bottom:10px}.mat-flat-button[_ngcontent-%COMP%]:not(:last-child){margin-right:10px!important}']}),n})()}];let H=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=t.oAB({type:n}),n.\u0275inj=t.cJS({imports:[u.Bz.forChild(Q),u.Bz]}),n})(),j=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=t.oAB({type:n}),n.\u0275inj=t.cJS({imports:[_.m]}),n})(),G=(()=>{class n{constructor(){}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=t.oAB({type:n}),n.\u0275inj=t.cJS({imports:[_.m,H,j]}),n})()}}]);